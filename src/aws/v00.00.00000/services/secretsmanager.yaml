openapi: 3.0.0
info:
  title: SecretsManager
  version: 1.0.0
paths: {}
components:
  schemas:
    ResourcePolicy:
      type: object
      properties:
        ResourcePolicy:
          type: object
        Id:
          type: string
        BlockPublicPolicy:
          type: boolean
        SecretId:
          type: string
      required:
        - SecretId
        - ResourcePolicy
      x-stackql-resource-name: resource_policy
      x-stackql-primaryIdentifier:
        - Id
    HostedRotationLambda:
      type: object
      additionalProperties: false
      properties:
        Runtime:
          type: string
        RotationType:
          type: string
        RotationLambdaName:
          type: string
        KmsKeyArn:
          type: string
        MasterSecretArn:
          type: string
        VpcSecurityGroupIds:
          type: string
        ExcludeCharacters:
          type: string
        MasterSecretKmsKeyArn:
          type: string
        SuperuserSecretArn:
          type: string
        SuperuserSecretKmsKeyArn:
          type: string
        VpcSubnetIds:
          type: string
      required:
        - RotationType
    RotationRules:
      type: object
      additionalProperties: false
      properties:
        ScheduleExpression:
          type: string
        Duration:
          type: string
        AutomaticallyAfterDays:
          type: integer
    RotationSchedule:
      type: object
      properties:
        Id:
          type: string
        RotationLambdaARN:
          type: string
        RotationRules:
          $ref: '#/components/schemas/RotationRules'
        RotateImmediatelyOnUpdate:
          type: boolean
        SecretId:
          type: string
        HostedRotationLambda:
          $ref: '#/components/schemas/HostedRotationLambda'
      required:
        - SecretId
      x-stackql-resource-name: rotation_schedule
      x-stackql-primaryIdentifier:
        - Id
    GenerateSecretString:
      type: object
      additionalProperties: false
      properties:
        ExcludeUppercase:
          type: boolean
        RequireEachIncludedType:
          type: boolean
        IncludeSpace:
          type: boolean
        ExcludeCharacters:
          type: string
        GenerateStringKey:
          type: string
        PasswordLength:
          type: integer
        ExcludePunctuation:
          type: boolean
        ExcludeLowercase:
          type: boolean
        SecretStringTemplate:
          type: string
        ExcludeNumbers:
          type: boolean
    ReplicaRegion:
      type: object
      additionalProperties: false
      properties:
        KmsKeyId:
          type: string
        Region:
          type: string
      required:
        - Region
    Tag:
      type: object
      additionalProperties: false
      properties:
        Value:
          type: string
        Key:
          type: string
      required:
        - Value
        - Key
    Secret:
      type: object
      properties:
        Description:
          type: string
        KmsKeyId:
          type: string
        SecretString:
          type: string
        GenerateSecretString:
          $ref: '#/components/schemas/GenerateSecretString'
        ReplicaRegions:
          type: array
          uniqueItems: false
          items:
            $ref: '#/components/schemas/ReplicaRegion'
        Id:
          type: string
        Tags:
          type: array
          uniqueItems: false
          items:
            $ref: '#/components/schemas/Tag'
        Name:
          type: string
      x-stackql-resource-name: secret
      x-stackql-primaryIdentifier:
        - Id
    SecretTargetAttachment:
      type: object
      properties:
        Id:
          type: string
        SecretId:
          type: string
        TargetType:
          type: string
        TargetId:
          type: string
      required:
        - TargetType
        - TargetId
        - SecretId
      x-stackql-resource-name: secret_target_attachment
      x-stackql-primaryIdentifier:
        - Id
  x-stackQL-resources:
    resource_policies:
      name: resource_policies
      id: aws.secretsmanager.resource_policies
      x-cfn-schema-name: ResourcePolicy
      x-type: list
      x-identifiers:
        - Id
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region,
              JSON_EXTRACT(Properties, '$.Id') as id
              FROM aws.cloud_control.resources WHERE data__TypeName = 'AWS::SecretsManager::ResourcePolicy'
    resource_policy:
      name: resource_policy
      id: aws.secretsmanager.resource_policy
      x-cfn-schema-name: ResourcePolicy
      x-type: get
      x-identifiers:
        - Id
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region,
              JSON_EXTRACT(Properties, '$.ResourcePolicy') as resource_policy,
              JSON_EXTRACT(Properties, '$.Id') as id,
              JSON_EXTRACT(Properties, '$.BlockPublicPolicy') as block_public_policy,
              JSON_EXTRACT(Properties, '$.SecretId') as secret_id
              FROM aws.cloud_control.resource WHERE data__TypeName = 'AWS::SecretsManager::ResourcePolicy'
    rotation_schedules:
      name: rotation_schedules
      id: aws.secretsmanager.rotation_schedules
      x-cfn-schema-name: RotationSchedule
      x-type: list
      x-identifiers:
        - Id
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region,
              JSON_EXTRACT(Properties, '$.Id') as id
              FROM aws.cloud_control.resources WHERE data__TypeName = 'AWS::SecretsManager::RotationSchedule'
    rotation_schedule:
      name: rotation_schedule
      id: aws.secretsmanager.rotation_schedule
      x-cfn-schema-name: RotationSchedule
      x-type: get
      x-identifiers:
        - Id
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region,
              JSON_EXTRACT(Properties, '$.Id') as id,
              JSON_EXTRACT(Properties, '$.RotationLambdaARN') as rotation_lambda_ar_n,
              JSON_EXTRACT(Properties, '$.RotationRules') as rotation_rules,
              JSON_EXTRACT(Properties, '$.RotateImmediatelyOnUpdate') as rotate_immediately_on_update,
              JSON_EXTRACT(Properties, '$.SecretId') as secret_id,
              JSON_EXTRACT(Properties, '$.HostedRotationLambda') as hosted_rotation_lambda
              FROM aws.cloud_control.resource WHERE data__TypeName = 'AWS::SecretsManager::RotationSchedule'
    secrets:
      name: secrets
      id: aws.secretsmanager.secrets
      x-cfn-schema-name: Secret
      x-type: list
      x-identifiers:
        - Id
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region,
              JSON_EXTRACT(Properties, '$.Id') as id
              FROM aws.cloud_control.resources WHERE data__TypeName = 'AWS::SecretsManager::Secret'
    secret:
      name: secret
      id: aws.secretsmanager.secret
      x-cfn-schema-name: Secret
      x-type: get
      x-identifiers:
        - Id
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region,
              JSON_EXTRACT(Properties, '$.Description') as description,
              JSON_EXTRACT(Properties, '$.KmsKeyId') as kms_key_id,
              JSON_EXTRACT(Properties, '$.SecretString') as secret_string,
              JSON_EXTRACT(Properties, '$.GenerateSecretString') as generate_secret_string,
              JSON_EXTRACT(Properties, '$.ReplicaRegions') as replica_regions,
              JSON_EXTRACT(Properties, '$.Id') as id,
              JSON_EXTRACT(Properties, '$.Tags') as tags,
              JSON_EXTRACT(Properties, '$.Name') as name
              FROM aws.cloud_control.resource WHERE data__TypeName = 'AWS::SecretsManager::Secret'
    secret_target_attachments:
      name: secret_target_attachments
      id: aws.secretsmanager.secret_target_attachments
      x-cfn-schema-name: SecretTargetAttachment
      x-type: list
      x-identifiers:
        - Id
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region,
              JSON_EXTRACT(Properties, '$.Id') as id
              FROM aws.cloud_control.resources WHERE data__TypeName = 'AWS::SecretsManager::SecretTargetAttachment'
    secret_target_attachment:
      name: secret_target_attachment
      id: aws.secretsmanager.secret_target_attachment
      x-cfn-schema-name: SecretTargetAttachment
      x-type: get
      x-identifiers:
        - Id
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region,
              JSON_EXTRACT(Properties, '$.Id') as id,
              JSON_EXTRACT(Properties, '$.SecretId') as secret_id,
              JSON_EXTRACT(Properties, '$.TargetType') as target_type,
              JSON_EXTRACT(Properties, '$.TargetId') as target_id
              FROM aws.cloud_control.resource WHERE data__TypeName = 'AWS::SecretsManager::SecretTargetAttachment'
