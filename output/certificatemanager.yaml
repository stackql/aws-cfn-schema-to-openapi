openapi: 3.0.0
info:
  title: CertificateManager
  version: 1.0.0
paths: {}
components:
  schemas:
    ExpiryEventsConfiguration:
      type: object
      additionalProperties: false
      properties:
        DaysBeforeExpiry:
          type: integer
          minimum: 1
          maximum: 45
    AccountId:
      type: string
    Account:
      type: object
      properties:
        ExpiryEventsConfiguration:
          $ref: '#/components/schemas/ExpiryEventsConfiguration'
        AccountId:
          $ref: '#/components/schemas/AccountId'
      required:
        - ExpiryEventsConfiguration
      x-stackql-resource-name: Account
    DomainValidationOption:
      type: object
      additionalProperties: false
      properties:
        DomainName:
          type: string
        ValidationDomain:
          type: string
        HostedZoneId:
          type: string
      required:
        - DomainName
    Tag:
      type: object
      additionalProperties: false
      properties:
        Value:
          type: string
        Key:
          type: string
      required:
        - Value
        - Key
    Certificate:
      type: object
      properties:
        CertificateAuthorityArn:
          type: string
        DomainValidationOptions:
          type: array
          uniqueItems: true
          items:
            $ref: '#/components/schemas/DomainValidationOption'
        CertificateTransparencyLoggingPreference:
          type: string
        DomainName:
          type: string
        ValidationMethod:
          type: string
        SubjectAlternativeNames:
          type: array
          uniqueItems: true
          items:
            type: string
        Id:
          type: string
        Tags:
          type: array
          uniqueItems: false
          items:
            $ref: '#/components/schemas/Tag'
      required:
        - DomainName
      x-stackql-resource-name: Certificate
x-stackql-views:
  - Account:
      name: Account
      id: aws.certificatemanager.Account
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region
              JSON_EXTRACT(Properties, '$.ExpiryEventsConfiguration.DaysBeforeExpiry') as expiry_events_configuration_days_before_expiry
              FROM aws.cloud_control.resources WHERE data__TypeName = 'AWS::CertificateManager::Account' ;
  - Certificate:
      name: Certificate
      id: aws.certificatemanager.Certificate
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              region
              JSON_EXTRACT(Properties, '$.CertificateAuthorityArn') as certificate_authority_arn,
              JSON_EXTRACT(Properties, '$.DomainValidationOptions') as domain_validation_options,
              JSON_EXTRACT(Properties, '$.CertificateTransparencyLoggingPreference') as certificate_transparency_logging_preference,
              JSON_EXTRACT(Properties, '$.DomainName') as domain_name,
              JSON_EXTRACT(Properties, '$.ValidationMethod') as validation_method,
              JSON_EXTRACT(Properties, '$.SubjectAlternativeNames') as subject_alternative_names,
              JSON_EXTRACT(Properties, '$.Id') as id,
              JSON_EXTRACT(Properties, '$.Tags') as tags
              FROM aws.cloud_control.resources WHERE data__TypeName = 'AWS::CertificateManager::Certificate' ;
