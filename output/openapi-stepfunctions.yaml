openapi: 3.0.0
info:
  title: StepFunctions
  version: 1.0.0
paths: {}
components:
  schemas:
    TagsEntry:
      type: object
      properties:
        Key:
          type: string
          minLength: 1
          maxLength: 128
        Value:
          type: string
          minLength: 1
          maxLength: 256
      additionalProperties: false
      required:
        - Key
        - Value
    Activity:
      type: object
      properties:
        Arn:
          type: string
          minLength: 1
          maxLength: 2048
          x-is-top-level-property: true
        Name:
          type: string
          minLength: 1
          maxLength: 80
          x-is-top-level-property: true
        Tags:
          type: array
          uniqueItems: false
          x-insertionOrder: false
          items:
            $ref: '#/components/schemas/TagsEntry'
          x-is-top-level-property: true
      required:
        - Name
      x-stackql-resource-name: Activity
    CloudWatchLogsLogGroup:
      type: object
      additionalProperties: false
      properties:
        LogGroupArn:
          type: string
          minLength: 1
          maxLength: 256
    LogDestination:
      type: object
      additionalProperties: false
      properties:
        CloudWatchLogsLogGroup:
          $ref: '#/components/schemas/CloudWatchLogsLogGroup'
    LoggingConfiguration:
      type: object
      additionalProperties: false
      properties:
        Level:
          type: string
          enum:
            - ALL
            - ERROR
            - FATAL
            - 'OFF'
        IncludeExecutionData:
          type: boolean
        Destinations:
          type: array
          minItems: 1
          x-insertionOrder: false
          items:
            $ref: '#/components/schemas/LogDestination'
    TracingConfiguration:
      type: object
      additionalProperties: false
      properties:
        Enabled:
          type: boolean
    S3Location:
      type: object
      additionalProperties: false
      properties:
        Bucket:
          type: string
        Key:
          type: string
        Version:
          type: string
      required:
        - Bucket
        - Key
    DefinitionSubstitutions:
      type: object
      additionalProperties: false
      x-patternProperties:
        .*:
          anyOf:
            - type: string
            - type: integer
            - type: boolean
      minProperties: 1
    Definition:
      type: object
      minProperties: 1
    StateMachine:
      type: object
      properties:
        Arn:
          type: string
          minLength: 1
          maxLength: 2048
          x-is-top-level-property: true
        Name:
          type: string
          minLength: 1
          maxLength: 80
          x-is-top-level-property: true
        DefinitionString:
          type: string
          minLength: 1
          maxLength: 1048576
          x-is-top-level-property: true
        RoleArn:
          type: string
          minLength: 1
          maxLength: 256
          x-is-top-level-property: true
        StateMachineName:
          type: string
          minLength: 1
          maxLength: 80
          x-is-top-level-property: true
        StateMachineType:
          type: string
          enum:
            - STANDARD
            - EXPRESS
          x-is-top-level-property: true
        StateMachineRevisionId:
          type: string
          minLength: 1
          maxLength: 256
          x-is-top-level-property: true
        LoggingConfiguration:
          $ref: '#/components/schemas/LoggingConfiguration'
          x-is-top-level-property: true
        TracingConfiguration:
          $ref: '#/components/schemas/TracingConfiguration'
          x-is-top-level-property: true
        DefinitionS3Location:
          $ref: '#/components/schemas/S3Location'
          x-is-top-level-property: true
        DefinitionSubstitutions:
          $ref: '#/components/schemas/DefinitionSubstitutions'
          x-is-top-level-property: true
        Definition:
          $ref: '#/components/schemas/Definition'
          x-is-top-level-property: true
        Tags:
          type: array
          uniqueItems: false
          x-insertionOrder: false
          items:
            $ref: '#/components/schemas/TagsEntry'
          x-is-top-level-property: true
      required:
        - RoleArn
      x-stackql-resource-name: StateMachine
x-stackql-views:
  - Activity:
      name: Activity
      id: aws.stepfunctions.Activity
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: >-
              SELECT 

              JSON_EXTRACT(Properties, '$.Arn') as arn,

              JSON_EXTRACT(Properties, '$.Name') as name,

              JSON_EXTRACT(Properties, '$.Tags') as tags

              FROM aws.cloud_control.resources WHERE region = 'ap-southeast-1'
              and data__TypeName = 'AWS::StepFunctions::Activity' ;
  - StateMachine:
      name: StateMachine
      id: aws.stepfunctions.StateMachine
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: >-
              SELECT 

              JSON_EXTRACT(Properties, '$.Arn') as arn,

              JSON_EXTRACT(Properties, '$.Name') as name,

              JSON_EXTRACT(Properties, '$.DefinitionString') as
              definition_string,

              JSON_EXTRACT(Properties, '$.RoleArn') as role_arn,

              JSON_EXTRACT(Properties, '$.StateMachineName') as
              state_machine_name,

              JSON_EXTRACT(Properties, '$.StateMachineType') as
              state_machine_type,

              JSON_EXTRACT(Properties, '$.StateMachineRevisionId') as
              state_machine_revision_id,

              JSON_EXTRACT(Properties, '$.LoggingConfiguration.Level') as
              logging_configuration_level,

              JSON_EXTRACT(Properties,
              '$.LoggingConfiguration.IncludeExecutionData') as
              logging_configuration_include_execution_data,

              JSON_EXTRACT(Properties, '$.LoggingConfiguration.Destinations') as
              logging_configuration_destinations,

              JSON_EXTRACT(Properties, '$.TracingConfiguration.Enabled') as
              tracing_configuration_enabled,

              JSON_EXTRACT(Properties, '$.DefinitionS3Location.Bucket') as
              definition_s3_location_bucket,

              JSON_EXTRACT(Properties, '$.DefinitionS3Location.Key') as
              definition_s3_location_key,

              JSON_EXTRACT(Properties, '$.DefinitionS3Location.Version') as
              definition_s3_location_version,

              JSON_EXTRACT(Properties, '$.Tags') as tags

              FROM aws.cloud_control.resources WHERE region = 'ap-southeast-1'
              and data__TypeName = 'AWS::StepFunctions::StateMachine' ;
