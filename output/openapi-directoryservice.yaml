openapi: 3.0.0
info:
  title: DirectoryService
  version: 1.0.0
paths: {}
components:
  schemas:
    VpcSettings:
      x-$comment: Contains VPC information
      type: object
      additionalProperties: false
      properties:
        SubnetIds:
          description: >-
            The identifiers of the subnets for the directory servers. The two
            subnets must be in different Availability Zones. AWS Directory
            Service specifies a directory server and a DNS server in each of
            these subnets.
          type: array
          uniqueItems: true
          x-insertionOrder: false
          items:
            type: string
        VpcId:
          description: The identifier of the VPC in which to create the directory.
          type: string
      required:
        - VpcId
        - SubnetIds
    MicrosoftAD:
      type: object
      properties:
        Id:
          type: string
          x-is-top-level-property: true
        Alias:
          type: string
          x-is-top-level-property: true
        DnsIpAddresses:
          type: array
          uniqueItems: false
          items:
            type: string
          x-is-top-level-property: true
        CreateAlias:
          type: boolean
          x-is-top-level-property: true
        Edition:
          type: string
          x-is-top-level-property: true
        EnableSso:
          type: boolean
          x-is-top-level-property: true
        Name:
          type: string
          x-is-top-level-property: true
        Password:
          type: string
          x-is-top-level-property: true
        ShortName:
          type: string
          x-is-top-level-property: true
        VpcSettings:
          $ref: '#/components/schemas/VpcSettings'
          x-is-top-level-property: true
      required:
        - VpcSettings
        - Name
        - Password
      x-stackql-resource-name: MicrosoftAD
    SimpleAD:
      type: object
      properties:
        DirectoryId:
          description: The unique identifier for a directory.
          type: string
          x-is-top-level-property: true
        Alias:
          description: The alias for a directory.
          type: string
          x-is-top-level-property: true
        DnsIpAddresses:
          description: >-
            The IP addresses of the DNS servers for the directory, such as [
            "172.31.3.154", "172.31.63.203" ].
          type: array
          uniqueItems: false
          x-insertionOrder: false
          items:
            type: string
          x-is-top-level-property: true
        CreateAlias:
          description: The name of the configuration set.
          type: boolean
          x-is-top-level-property: true
        Description:
          description: Description for the directory.
          type: string
          x-is-top-level-property: true
        EnableSso:
          description: >-
            Whether to enable single sign-on for a Simple Active Directory in
            AWS.
          type: boolean
          x-is-top-level-property: true
        Name:
          description: >-
            The fully qualified domain name for the AWS Managed Simple AD
            directory.
          type: string
          x-is-top-level-property: true
        Password:
          description: The password for the default administrative user named Admin.
          type: string
          x-is-top-level-property: true
        ShortName:
          description: The NetBIOS name for your domain.
          type: string
          x-is-top-level-property: true
        Size:
          description: The size of the directory.
          type: string
          x-is-top-level-property: true
        VpcSettings:
          description: VPC settings of the Simple AD directory server in AWS.
          $ref: '#/components/schemas/VpcSettings'
          x-is-top-level-property: true
      required:
        - VpcSettings
        - Size
        - Name
      x-stackql-resource-name: SimpleAD
x-stackql-views:
  - MicrosoftAD:
      name: MicrosoftAD
      id: aws.directoryservice.MicrosoftAD
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: >-
              SELECT 

              JSON_EXTRACT(Properties, '$.Id') as id,

              JSON_EXTRACT(Properties, '$.Alias') as alias,

              JSON_EXTRACT(Properties, '$.DnsIpAddresses') as dns_ip_addresses,

              JSON_EXTRACT(Properties, '$.CreateAlias') as create_alias,

              JSON_EXTRACT(Properties, '$.Edition') as edition,

              JSON_EXTRACT(Properties, '$.EnableSso') as enable_sso,

              JSON_EXTRACT(Properties, '$.Name') as name,

              JSON_EXTRACT(Properties, '$.Password') as password,

              JSON_EXTRACT(Properties, '$.ShortName') as short_name,

              JSON_EXTRACT(Properties, '$.VpcSettings.SubnetIds') as
              vpc_settings_subnet_ids,

              JSON_EXTRACT(Properties, '$.VpcSettings.VpcId') as
              vpc_settings_vpc_id

              FROM aws.cloud_control.resources WHERE region = 'ap-southeast-1'
              and data__TypeName = 'AWS::DirectoryService::MicrosoftAD' ;
  - SimpleAD:
      name: SimpleAD
      id: aws.directoryservice.SimpleAD
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: >-
              SELECT 

              JSON_EXTRACT(Properties, '$.DirectoryId') as directory_id,

              JSON_EXTRACT(Properties, '$.Alias') as alias,

              JSON_EXTRACT(Properties, '$.DnsIpAddresses') as dns_ip_addresses,

              JSON_EXTRACT(Properties, '$.CreateAlias') as create_alias,

              JSON_EXTRACT(Properties, '$.Description') as description,

              JSON_EXTRACT(Properties, '$.EnableSso') as enable_sso,

              JSON_EXTRACT(Properties, '$.Name') as name,

              JSON_EXTRACT(Properties, '$.Password') as password,

              JSON_EXTRACT(Properties, '$.ShortName') as short_name,

              JSON_EXTRACT(Properties, '$.Size') as size,

              JSON_EXTRACT(Properties, '$.VpcSettings.SubnetIds') as
              vpc_settings_subnet_ids,

              JSON_EXTRACT(Properties, '$.VpcSettings.VpcId') as
              vpc_settings_vpc_id

              FROM aws.cloud_control.resources WHERE region = 'ap-southeast-1'
              and data__TypeName = 'AWS::DirectoryService::SimpleAD' ;
