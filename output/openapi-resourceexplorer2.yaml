openapi: 3.0.0
info:
  title: ResourceExplorer2
  version: 1.0.0
paths: {}
components:
  schemas:
    DefaultViewAssociation:
      type: object
      properties:
        ViewArn:
          type: string
          x-is-top-level-property: true
        AssociatedAwsPrincipal:
          description: >-
            The AWS principal that the default view is associated with, used as
            the unique identifier for this resource.
          type: string
          pattern: ^[0-9]{12}$
          x-is-top-level-property: true
      required:
        - ViewArn
      x-stackql-resource-name: DefaultViewAssociation
    IndexType:
      type: string
      enum:
        - LOCAL
        - AGGREGATOR
    TagMap:
      type: object
      x-patternProperties:
        .+:
          type: string
      additionalProperties: false
    IndexState:
      type: string
      enum:
        - ACTIVE
        - CREATING
        - DELETING
        - DELETED
        - UPDATING
    Index:
      type: object
      properties:
        Arn:
          type: string
          x-is-top-level-property: true
        Tags:
          $ref: '#/components/schemas/TagMap'
          x-is-top-level-property: true
        Type:
          $ref: '#/components/schemas/IndexType'
          x-is-top-level-property: true
        IndexState:
          $ref: '#/components/schemas/IndexState'
          x-is-top-level-property: true
      required:
        - Type
      x-stackql-resource-name: Index
    IncludedProperty:
      type: object
      properties:
        Name:
          type: string
      required:
        - Name
      additionalProperties: false
    Filters:
      type: object
      properties:
        FilterString:
          type: string
      required:
        - FilterString
      additionalProperties: false
    View:
      type: object
      properties:
        IncludedProperties:
          type: array
          items:
            $ref: '#/components/schemas/IncludedProperty'
          x-insertionOrder: false
          x-is-top-level-property: true
        Filters:
          $ref: '#/components/schemas/Filters'
          x-is-top-level-property: true
        Tags:
          $ref: '#/components/schemas/TagMap'
          x-is-top-level-property: true
        ViewArn:
          type: string
          x-is-top-level-property: true
        ViewName:
          type: string
          pattern: ^[a-zA-Z0-9\-]{1,64}$
          x-is-top-level-property: true
      required:
        - ViewName
      x-stackql-resource-name: View
x-stackql-views:
  - DefaultViewAssociation:
      name: DefaultViewAssociation
      id: aws.resourceexplorer2.DefaultViewAssociation
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: >-
              SELECT 

              JSON_EXTRACT(Properties, '$.ViewArn') as view_arn,

              JSON_EXTRACT(Properties, '$.AssociatedAwsPrincipal') as
              associated_aws_principal

              FROM aws.cloud_control.resources WHERE region = 'ap-southeast-1'
              and data__TypeName =
              'AWS::ResourceExplorer2::DefaultViewAssociation' ;
  - Index:
      name: Index
      id: aws.resourceexplorer2.Index
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: >-
              SELECT 

              JSON_EXTRACT(Properties, '$.Arn') as arn

              FROM aws.cloud_control.resources WHERE region = 'ap-southeast-1'
              and data__TypeName = 'AWS::ResourceExplorer2::Index' ;
  - View:
      name: View
      id: aws.resourceexplorer2.View
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: >-
              SELECT 

              JSON_EXTRACT(Properties, '$.IncludedProperties') as
              included_properties,

              JSON_EXTRACT(Properties, '$.Filters.FilterString') as
              filters_filter_string,

              JSON_EXTRACT(Properties, '$.ViewArn') as view_arn,

              JSON_EXTRACT(Properties, '$.ViewName') as view_name

              FROM aws.cloud_control.resources WHERE region = 'ap-southeast-1'
              and data__TypeName = 'AWS::ResourceExplorer2::View' ;
