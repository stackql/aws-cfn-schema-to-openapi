openapi: 3.0.0
info:
  title: SSMContacts
  version: 1.0.0
paths: {}
components:
  schemas:
    ContactTargetInfo:
      type: object
      description: The contact that SSM Incident Manager is engaging during an incident.
      properties:
        ContactId:
          description: The Amazon Resource Name (ARN) of the contact.
          type: string
        IsEssential:
          type: boolean
          description: A Boolean value determining if the contact's acknowledgement stops the progress of stages in the plan.
      required:
        - ContactId
        - IsEssential
      additionalProperties: false
    ChannelTargetInfo:
      type: object
      description: Information about the contact channel that SSM Incident Manager uses to engage the contact.
      properties:
        ChannelId:
          description: The Amazon Resource Name (ARN) of the contact channel.
          type: string
        RetryIntervalInMinutes:
          type: integer
          description: The number of minutes to wait to retry sending engagement in the case the engagement initially fails.
      required:
        - ChannelId
        - RetryIntervalInMinutes
      additionalProperties: false
    Stage:
      description: A set amount of time that an escalation plan or engagement plan engages the specified contacts or contact methods.
      type: object
      properties:
        DurationInMinutes:
          description: The time to wait until beginning the next stage.
          type: integer
        Targets:
          type: array
          description: The contacts or contact methods that the escalation plan or engagement plan is engaging.
          items:
            $ref: '#/components/schemas/Targets'
      required:
        - DurationInMinutes
      additionalProperties: false
    Targets:
      description: The contacts or contact methods that the escalation plan or engagement plan is engaging.
      type: object
      properties:
        ContactTargetInfo:
          $ref: '#/components/schemas/ContactTargetInfo'
        ChannelTargetInfo:
          $ref: '#/components/schemas/ChannelTargetInfo'
      additionalProperties: false
      oneOf:
        - required:
            - ChannelTargetInfo
        - required:
            - ContactTargetInfo
    Contact:
      type: object
      properties:
        Alias:
          description: Alias of the contact. String value with 20 to 256 characters. Only alphabetical, numeric characters, dash, or underscore allowed.
          type: string
          minLength: 1
          maxLength: 255
          pattern: ^[a-z0-9_\-\.]*$
        DisplayName:
          description: Name of the contact. String value with 3 to 256 characters. Only alphabetical, space, numeric characters, dash, or underscore allowed.
          type: string
          minLength: 1
          maxLength: 255
          pattern: ^[a-zA-Z0-9_\-\s]*$
        Type:
          description: 'Contact type, which specify type of contact. Currently supported values: “PERSONAL”, “SHARED”, “OTHER“.'
          type: string
          enum:
            - PERSONAL
            - CUSTOM
            - SERVICE
            - ESCALATION
        Plan:
          description: The stages that an escalation plan or engagement plan engages contacts and contact methods in.
          type: array
          items:
            $ref: '#/components/schemas/Stage'
        Arn:
          type: string
          description: The Amazon Resource Name (ARN) of the contact.
      required:
        - Alias
        - DisplayName
        - Type
      x-stackql-resource-name: Contact
    ContactChannel:
      type: object
      properties:
        ContactId:
          description: ARN of the contact resource
          type: string
          minLength: 1
          maxLength: 2048
          pattern: arn:[-\w+=\/,.@]+:[-\w+=\/,.@]+:[-\w+=\/,.@]*:[0-9]+:([\w+=\/,.@:-]+)*
        ChannelName:
          description: The device name. String of 6 to 50 alphabetical, numeric, dash, and underscore characters.
          type: string
          minLength: 1
          maxLength: 255
          pattern: '[a-zA-Z 0-9_\-+''&amp;\uD83C-\uDBFF\uDC00-\uDFFF\u2000-\u3300]+'
        ChannelType:
          description: 'Device type, which specify notification channel. Currently supported values: “SMS”, “VOICE”, “EMAIL”, “CHATBOT.'
          type: string
          enum:
            - SMS
            - VOICE
            - EMAIL
        DeferActivation:
          type: boolean
          description: If you want to activate the channel at a later time, you can choose to defer activation. SSM Incident Manager can't engage your contact channel until it has been activated.
        ChannelAddress:
          description: The details that SSM Incident Manager uses when trying to engage the contact channel.
          type: string
        Arn:
          type: string
          description: The Amazon Resource Name (ARN) of the engagement to a contact channel.
      x-stackql-resource-name: ContactChannel
x-stackql-views:
  - Contact:
      name: Contact
      id: aws.ssmcontacts.Contact
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              JSON_EXTRACT(Properties, '$.Alias') as alias,
              JSON_EXTRACT(Properties, '$.DisplayName') as display_name,
              JSON_EXTRACT(Properties, '$.Type') as type,
              JSON_EXTRACT(Properties, '$.Plan') as plan,
              JSON_EXTRACT(Properties, '$.Arn') as arn
              FROM aws.cloud_control.resources WHERE region = 'ap-southeast-1' and data__TypeName = 'AWS::SSMContacts::Contact' ;
  - ContactChannel:
      name: ContactChannel
      id: aws.ssmcontacts.ContactChannel
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              JSON_EXTRACT(Properties, '$.ContactId') as contact_id,
              JSON_EXTRACT(Properties, '$.ChannelName') as channel_name,
              JSON_EXTRACT(Properties, '$.ChannelType') as channel_type,
              JSON_EXTRACT(Properties, '$.DeferActivation') as defer_activation,
              JSON_EXTRACT(Properties, '$.ChannelAddress') as channel_address,
              JSON_EXTRACT(Properties, '$.Arn') as arn
              FROM aws.cloud_control.resources WHERE region = 'ap-southeast-1' and data__TypeName = 'AWS::SSMContacts::ContactChannel' ;
