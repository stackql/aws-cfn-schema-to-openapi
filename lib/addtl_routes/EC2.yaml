openapi: 3.0.0
info:
  title: EC2
  description: Additional stackql views for EC2
  version: 1.0.0
paths: {}
components:
  schemas:
    region:
      type: string
      description: The AWS region
    outpostArn:
      type: string
      description: The Amazon Resource Name (ARN) of the Outpost.
    ownerId:
      type: string
      description: The ID of the Amazon Web Services account that owns the resource.
    # vpcId:  
    #   type: string  
    #   description: '[EC2-VPC] The ID of the VPC in which the resource is located.' 
    # subnetId:  
    #   type: string  
    #   description: '[EC2-VPC] The ID of the subnet in which the resource is located.' 
    tagSet:  
      type: array  
      description: Any tags assigned to the resource.
    # availabilityZone:
    #   type: string
    #   description: The Availability Zone where the resource was created, if applicable.      
    # instances:
    #   description: List of ec2 instances by region (requires `aws` provider to be installed)
    #   type: object
    #   additionalProperties: false
    #   properties:
    #     instanceId:  
    #       type: string  
    #       description: The ID of the instance.
    #     instanceState:  
    #       type: object  
    #       description: Describes the current state of an instance.
    #     instanceType:  
    #       type: string  
    #       description: The instance type.
    #     vpcId: 
    #       $ref: '#/components/schemas/vpcId' 
    #     subnetId:  
    #       $ref: '#/components/schemas/subnetId'
    #     amiLaunchIndex:  
    #       type: integer  
    #       description: The AMI launch index, which can be used to find this instance in the launch group.
    #     architecture:  
    #       type: string  
    #       description: The architecture of the image.
    #     blockDeviceMapping:  
    #       type: array  
    #       description: Any block device mapping entries for the instance.
    #     bootMode:  
    #       type: string  
    #       description: The boot mode of the instance.
    #     capacityReservationId:  
    #       type: string  
    #       description: The ID of the Capacity Reservation.
    #     capacityReservationSpecification:  
    #       type: object  
    #       description: Describes the instances Capacity Reservation targeting preferences
    #     clientToken:  
    #       type: string  
    #       description: The idempotency token you provided when you launched the instance, if applicable.
    #     cpuOptions:  
    #       type: object  
    #       description: The CPU options for the instance.
    #     dnsName:  
    #       type: string  
    #       description: (IPv4 only) The public DNS name assigned to the instance.
    #     ebsOptimized:  
    #       type: boolean  
    #       description: Indicates whether the instance is optimized for Amazon EBS I/O.
    #     elasticGpuAssociationSet:  
    #       type: array  
    #       description: The Elastic GPU associated with the instance.
    #     elasticInferenceAcceleratorAssociationSet:  
    #       type: array  
    #       description: The elastic inference accelerator associated with the instance.
    #     enaSupport:  
    #       type: boolean  
    #       description: Specifies whether enhanced networking with ENA is enabled.
    #     enclaveOptions:  
    #       type: object  
    #       description: Indicates whether the instance is enabled for Amazon Web Services Nitro Enclaves.
    #     groupSet:  
    #       type: array  
    #       description: The security groups for the instance.
    #     hibernationOptions:  
    #       type: object  
    #       description: Indicates whether your instance is configured for hibernation.
    #     hypervisor:  
    #       type: string  
    #       description: The hypervisor type of the instance.
    #     iamInstanceProfile:  
    #       type: object  
    #       description: Describes an IAM instance profile.
    #     imageId:  
    #       type: string  
    #       description: The ID of the AMI used to launch the instance.
    #     instanceLifecycle:  
    #       type: string  
    #       description: Indicates whether this is a Spot Instance or a Scheduled Instance.
    #     ipAddress:  
    #       type: string  
    #       description: The public IPv4 address, or the Carrier IP address assigned to the instance, if applicable.
    #     ipv6Address:  
    #       type: string  
    #       description: The IPv6 address assigned to the instance.
    #     kernelId:  
    #       type: string  
    #       description: The kernel associated with this instance, if applicable.
    #     keyName:  
    #       type: string  
    #       description: The name of the key pair, if this instance was launched with an associated key pair.
    #     launchTime:  
    #       type: string  
    #       description: The time the instance was launched.
    #     licenseSet:  
    #       type: array  
    #       description: The license configurations for the instance.
    #     maintenanceOptions:  
    #       type: object  
    #       description: The maintenance options for the instance.
    #     metadataOptions:  
    #       type: object  
    #       description: The metadata options for the instance.
    #     monitoring:  
    #       type: object  
    #       description: Describes the monitoring of an instance.
    #     networkInterfaceSet:  
    #       type: array  
    #       description: '[EC2-VPC] The network interfaces for the instance.'
    #     outpostArn:  
    #       $ref: '#/components/schemas/outpostArn'
    #     placement:  
    #       type: object  
    #       description: Describes the placement of an instance.
    #     platform:  
    #       type: string  
    #       description: The value is Windows instances; otherwise blank.
    #     platformDetails:  
    #       type: string  
    #       description: The platform details value for the instance.
    #     privateDnsName:  
    #       type: string  
    #       description: (IPv4 only) The private DNS hostname name assigned to the instance.
    #     privateDnsNameOptions:  
    #       type: object  
    #       description: Describes the options for instance hostnames.
    #     privateIpAddress:  
    #       type: string  
    #       description: The private IPv4 address assigned to the instance.
    #     productCodes:  
    #       type: array  
    #       description: The product codes attached to this instance, if applicable.
    #     ramdiskId:  
    #       type: string  
    #       description: The RAM disk associated with this instance, if applicable.
    #     reason:  
    #       type: string  
    #       description: The reason for the most recent state transition. This might be an empty string.
    #     rootDeviceName:  
    #       type: string  
    #       description: The device name of the root device volume.
    #     rootDeviceType:  
    #       type: string  
    #       description: The root device type used by the AMI. The AMI can use an EBS volume or an instance store volume.
    #     sourceDestCheck:  
    #       type: boolean  
    #       description: Indicates whether source/destination checking is enabled.
    #     spotInstanceRequestId:  
    #       type: string  
    #       description: If the request is a Spot Instance request, the ID of the request.
    #     sriovNetSupport:  
    #       type: string  
    #       description: Specifies whether enhanced networking with the Intel 82599 Virtual Function interface is enabled.
    #     stateReason:  
    #       type: object  
    #       description: Describes a state change.
    #     tagSet: 
    #       $ref: '#/components/schemas/tagSet'
    #     tpmSupport:  
    #       type: string  
    #       description: If the instance is configured for NitroTPM support
    #     usageOperation:  
    #       type: string  
    #       description: The usage operation value for the instance.
    #     usageOperationUpdateTime:  
    #       type: string  
    #       description: The time that the usage operation was last updated.
    #     virtualizationType:  
    #       type: string  
    #       description: The virtualization type of the instance.
    #     region:
    #       $ref: '#/components/schemas/region'
    #   x-example-where-clause: WHERE region = '<region>'      
    snapshots:
      description: List of snapshots by region (requires `aws` provider to be installed)
      type: object
      additionalProperties: false
      properties:
        description:
          type: string
          description: The description for the snapshot.
        dataEncryptionKeyId:
          type: string
          description: The data encryption key identifier for the snapshot.
        encrypted:
          type: boolean
          description: Indicates whether the snapshot is encrypted.
        kmsKeyId:
          type: string
          description: The Amazon Resource Name (ARN) of the Key Management Service (KMS) KMS key that was used to protect the volume encryption key for the parent volume.
        outpostArn:
          $ref: '#/components/schemas/outpostArn'
        ownerAlias:
          type: string
          description: The Amazon Web Services owner alias.
        ownerId:
          $ref: '#/components/schemas/ownerId'
        progress:
          type: string
          description: The progress of the snapshot, as a percentage.
        restoreExpiryTime:
          type: string
          description: Only for archived snapshots that are temporarily restored. Indicates the date and time when a temporarily restored snapshot will be automatically re-archived.
        snapshotId:
          type: string
          description: The ID of the snapshot. Each snapshot receives a unique identifier when it is created.
        startTime:
          type: string
          description: The time stamp when the snapshot was initiated.
        status:
          type: string
          description: The snapshot state.
        statusMessage:
          type: string
          description: Encrypted Amazon EBS snapshots are copied asynchronously. If a snapshot copy operation fails (for example, if the proper Key Management Service (KMS) permissions are not obtained) this field displays error state details.
        storageTier:
          type: string
          description: The storage tier in which the snapshot is stored.
        tagSet:
          $ref: '#/components/schemas/tagSet'
        volumeId:
          type: string
          description: The ID of the volume that was used to create the snapshot.
        volumeSize:
          type: integer
          description: The size of the volume, in GiB.
        region:
          $ref: '#/components/schemas/region'
      x-example-where-clause: WHERE region = '<region>'
  x-stackQL-resources:
    # instances:
    #   name: instances
    #   id: awscc.ec2.instances
    #   x-cfn-schema-name: instances
    #   x-type: custom_list
    #   config:
    #     views:
    #       select:
    #         predicate: sqlDialect == "sqlite3"
    #         ddl: |-
    #           SELECT
    #           instanceId,
    #           instanceState,
    #           instanceType,
    #           vpcId,
    #           subnetId,
    #           amiLaunchIndex,
    #           architecture,
    #           blockDeviceMapping,
    #           bootMode,
    #           capacityReservationId,
    #           capacityReservationSpecification,
    #           clientToken,
    #           cpuOptions,
    #           dnsName,
    #           ebsOptimized,
    #           elasticGpuAssociationSet,
    #           elasticInferenceAcceleratorAssociationSet,
    #           enaSupport,
    #           enclaveOptions,
    #           groupSet,
    #           hibernationOptions,
    #           hypervisor,
    #           iamInstanceProfile,
    #           imageId,
    #           instanceLifecycle,
    #           ipAddress,
    #           ipv6Address,
    #           kernelId,
    #           keyName,
    #           launchTime,
    #           licenseSet,
    #           maintenanceOptions,
    #           metadataOptions,
    #           monitoring,
    #           networkInterfaceSet,
    #           outpostArn,
    #           placement,
    #           platform,
    #           platformDetails,
    #           privateDnsName,
    #           privateDnsNameOptions,
    #           privateIpAddress,
    #           productCodes,
    #           ramdiskId,
    #           reason,
    #           rootDeviceName,
    #           rootDeviceType,
    #           sourceDestCheck,
    #           spotInstanceRequestId,
    #           sriovNetSupport,
    #           stateReason,
    #           tagSet,
    #           tpmSupport,
    #           usageOperation,
    #           usageOperationUpdateTime,
    #           virtualizationType,
    #           region
    #           FROM aws.ec2.instances
    #           WHERE region = 'us-east-1'
    snapshots:
      name: snapshots
      id: aws.ec2.snapshots
      x-cfn-schema-name: snapshots
      x-type: view
      config:
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
              description,
              dataEncryptionKeyId,
              encrypted,
              kmsKeyId,
              outpostArn,
              ownerAlias,
              ownerId,
              progress,
              restoreExpiryTime,
              snapshotId,
              startTime,
              status,
              statusMessage,
              storageTier,
              tagSet,
              volumeId,
              volumeSize,
              region
              FROM aws.ec2_api.snapshots
              WHERE region = 'us-east-1'